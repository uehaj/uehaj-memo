<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 2.20.8"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" href="/uehaj-memo/rss.xml"/><link rel="icon" href="/uehaj-memo/icons/icon-48x48.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="manifest" href="/uehaj-memo/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/uehaj-memo/icons/icon-48x48.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="72x72" href="/uehaj-memo/icons/icon-72x72.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="96x96" href="/uehaj-memo/icons/icon-96x96.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="144x144" href="/uehaj-memo/icons/icon-144x144.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="192x192" href="/uehaj-memo/icons/icon-192x192.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="256x256" href="/uehaj-memo/icons/icon-256x256.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="384x384" href="/uehaj-memo/icons/icon-384x384.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="512x512" href="/uehaj-memo/icons/icon-512x512.png?v=edf3d310d67f8284a562bc3a58c3e761"/><title data-react-helmet="true">Redux-Sagaでテトリス風ゲームを実装して学んだこと|Gatsby Starter Blog Grommet v2</title><meta data-react-helmet="true" name="description" content="はじめに React #1 Advent Calendar 2017の11日目です。 Reduxのミドルウェア「Redux-saga…"/><style data-styled="cxdnGv eUfLDp  ibXjqB gKMlfy hiQlop fbPEuv cRdLPJ fmlxal konoRe juZNvr cHqCJo kTNrrC cPEInk dusloy koruWX fhTKrx egLqqe kPraOX cXcbzr gqUMTP hehAPz gAyINP jRjNKe ffajHy AGUoN fYEUgR ikIgfp fIeKgP fiDkPX jfbKsv iOkQrb bUsBUB hGMbC UumnI gRPiLc" data-styled-version="4.4.1">
/* sc-component-id: StyledIcon-ofa7kd-0 */
.iOkQrb{display:inline-block;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;width:24px;height:24px;fill:#666666;stroke:#666666;} .iOkQrb g{fill:inherit;stroke:inherit;} .iOkQrb *:not([stroke])[fill="none"]{stroke-width:0;} .iOkQrb *[stroke*="#"],.iOkQrb *[STROKE*="#"]{stroke:inherit;fill:none;} .iOkQrb *[fill-rule],.iOkQrb *[FILL-RULE],.iOkQrb *[fill*="#"],.iOkQrb *[FILL*="#"]{fill:inherit;stroke:none;}
/* sc-component-id: StyledBox-sc-13pk1d4-0 */
.ibXjqB{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.gKMlfy{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:1152px;}.hiQlop{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;margin:12px;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;} @media only screen and (max-width:1000px){.hiQlop{margin:6px;}}.fbPEuv{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;} @media only screen and (max-width:1000px){.fbPEuv{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-flex-basis:auto;-ms-flex-preferred-size:auto;flex-basis:auto;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;}}.cRdLPJ{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex:1 0;-ms-flex:1 0;flex:1 0;-webkit-flex-basis:768px;-ms-flex-preferred-size:768px;flex-basis:768px;} @media only screen and (max-width:1000px){.cRdLPJ{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-flex-basis:auto;-ms-flex-preferred-size:auto;flex-basis:auto;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;}}.fmlxal{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;margin:12px;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border-radius:12px;} @media only screen and (max-width:1000px){.fmlxal{margin:6px;}} @media only screen and (max-width:1000px){.fmlxal{border-radius:6px;}}.konoRe{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding-left:24px;padding-right:24px;} @media only screen and (max-width:1000px){.konoRe{padding-left:12px;padding-right:12px;}}.juZNvr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;margin:48px;min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;} @media only screen and (max-width:1000px){.juZNvr{margin:24px;}}.cHqCJo{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}.kTNrrC{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-flex-basis:384px;-ms-flex-preferred-size:384px;flex-basis:384px;}.cPEInk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;margin:12px;border:solid 1px rgba(0,0,0,0.33);min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:24px;border-radius:12px;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;overflow:hidden;} @media only screen and (max-width:1000px){.cPEInk{margin:6px;}} @media only screen and (max-width:1000px){.cPEInk{border:solid 1px rgba(0,0,0,0.33);}} @media only screen and (max-width:1000px){.cPEInk{padding:12px;}} @media only screen and (max-width:1000px){.cPEInk{border-radius:6px;}}.dusloy{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;margin-bottom:12px;margin-left:0px;margin-right:12px;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:96px;width:96px;border-radius:12px;overflow:hidden;} @media only screen and (max-width:1000px){.dusloy{margin-bottom:6px;}} @media only screen and (max-width:1000px){.dusloy{margin-left:0px;}} @media only screen and (max-width:1000px){.dusloy{margin-right:6px;}} @media only screen and (max-width:1000px){.dusloy{border-radius:6px;}}.koruWX{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.fhTKrx{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.egLqqe{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;overflow:hidden;}.kPraOX{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(61,19,141,0.1);border:solid 1px rgba(0,0,0,0.33);min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;padding-left:24px;padding-right:24px;padding-top:12px;padding-bottom:12px;border-radius:12px;box-shadow:0px 2px 4px rgba(0,0,0,0.20);} @media only screen and (max-width:1000px){.kPraOX{border:solid 1px rgba(0,0,0,0.33);}} @media only screen and (max-width:1000px){.kPraOX{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-flex-basis:auto;-ms-flex-preferred-size:auto;flex-basis:auto;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;}} @media only screen and (max-width:1000px){.kPraOX{padding-left:12px;padding-right:12px;}} @media only screen and (max-width:1000px){.kPraOX{padding-top:6px;padding-bottom:6px;}} @media only screen and (max-width:1000px){.kPraOX{border-radius:6px;}}.cXcbzr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:48px;} @media only screen and (max-width:1000px){.cXcbzr{padding:24px;}}
/* sc-component-id: StyledBox__StyledBoxGap-sc-13pk1d4-1 */
.bUsBUB{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;-webkit-align-self:stretch;-ms-flex-item-align:stretch;align-self:stretch;width:12px;}.hGMbC{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;-webkit-align-self:stretch;-ms-flex-item-align:stretch;align-self:stretch;width:48px;}
/* sc-component-id: StyledButton-sc-323bzc-0 */
.fIeKgP{display:inline-block;box-sizing:border-box;cursor:pointer;outline:none;font:inherit;-webkit-text-decoration:none;text-decoration:none;margin:0;background:transparent;overflow:visible;text-transform:none;border:2px solid;border-radius:18px;color:#444444;padding:4px 22px;font-size:18px;line-height:24px;-webkit-transition-property:color,background-color,border-color,box-shadow;transition-property:color,background-color,border-color,box-shadow;-webkit-transition-duration:0.1s;transition-duration:0.1s;-webkit-transition-timing-function:ease-in-out;transition-timing-function:ease-in-out;} .fIeKgP:hover{background-color:rgba(221,221,221,0.4);color:#000000;box-shadow:0px 0px 0px 2px;}.fiDkPX{display:inline-block;box-sizing:border-box;cursor:pointer;outline:none;font:inherit;-webkit-text-decoration:none;text-decoration:none;margin:0;background:transparent;overflow:visible;text-transform:none;color:inherit;border:none;padding:0;text-align:inherit;line-height:0;padding:12px;}.jfbKsv{display:inline-block;box-sizing:border-box;cursor:pointer;outline:none;font:inherit;-webkit-text-decoration:none;text-decoration:none;margin:0;background:transparent;overflow:visible;text-transform:none;color:inherit;border:none;padding:0;text-align:inherit;}
/* sc-component-id: StyledHeading-sc-1rdh4aw-0 */
.gqUMTP{margin:12px;font-size:50px;line-height:56px;max-width:1200px;font-weight:600;text-align:center;} @media only screen and (max-width:1000px){.gqUMTP{margin:6px;}} @media only screen and (max-width:1000px){.gqUMTP{font-size:34px;line-height:40px;max-width:816px;}}.hehAPz{margin-top:48px;margin-bottom:12px;font-size:50px;line-height:56px;max-width:1200px;font-weight:600;} @media only screen and (max-width:1000px){.hehAPz{margin-top:24px;}} @media only screen and (max-width:1000px){.hehAPz{margin-bottom:6px;}} @media only screen and (max-width:1000px){.hehAPz{font-size:34px;line-height:40px;max-width:816px;}}
/* sc-component-id: StyledAnchor-sc-1rp7lwl-0 */
.gRPiLc{box-sizing:border-box;font-size:inherit;line-height:inherit;font-weight:600;-webkit-text-decoration:none;text-decoration:none;cursor:pointer;outline:none;} .gRPiLc:hover{-webkit-text-decoration:underline;text-decoration:underline;}
/* sc-component-id: StyledText-sc-1sadyjn-0 */
.gAyINP{font-size:18px;line-height:24px;text-align:center;color:#444444;}.jRjNKe{margin-bottom:12px;font-size:18px;line-height:24px;}.ffajHy{font-size:22px;line-height:28px;color:#444444;font-weight:bold;}.AGUoN{font-size:14px;line-height:20px;color:#444444;}.fYEUgR{margin-left:6px;margin-right:6px;font-size:22px;line-height:28px;color:#444444;font-weight:bold;}.ikIgfp{font-size:18px;line-height:24px;color:#444444;}
/* sc-component-id: StyledGrommet-sc-19lkkz7-0 */
.cxdnGv{font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial,sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-size:18px;line-height:24px;background:#ffffff;color:#444444;box-sizing:border-box;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;}.eUfLDp{font-size:18px;line-height:24px;box-sizing:border-box;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;}
/* sc-component-id: StyledImage-ey4zx9-0 */
.UumnI{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;overflow:hidden;object-fit:cover;}
/* sc-component-id: sc-global-4065286833 */
img{max-width:100%;} body{margin:0;} a:hover{opacity:0.9;}</style><link as="script" rel="preload" href="/uehaj-memo/webpack-runtime-fb996b323eeedf59d2e2.js"/><link as="script" rel="preload" href="/uehaj-memo/framework-a61069b645629c49bb6a.js"/><link as="script" rel="preload" href="/uehaj-memo/app-e0726d491e263e7a514d.js"/><link as="script" rel="preload" href="/uehaj-memo/7f7e17e10404ffebb7b543ed2a7939618d5b9b2d-c38ec7352d8148819306.js"/><link as="script" rel="preload" href="/uehaj-memo/02d529e9c63de17f611aad8b1faf348db0081e69-ac0923b45693387c242c.js"/><link as="script" rel="preload" href="/uehaj-memo/component---src-templates-blog-post-tsx-99185ea61b7c1db80950.js"/><link as="fetch" rel="preload" href="/uehaj-memo/page-data/blog/eaa039a7ce44d5969f06/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/uehaj-memo/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="StyledGrommet-sc-19lkkz7-0 cxdnGv"><div class="StyledGrommet-sc-19lkkz7-0 eUfLDp"><div class="StyledBox-sc-13pk1d4-0 ibXjqB"><div class="StyledBox-sc-13pk1d4-0 gKMlfy"><header><div class="StyledBox-sc-13pk1d4-0 hiQlop"><a style="box-shadow:none;text-decoration:none" href="/uehaj-memo/"><h1 class="StyledHeading-sc-1rdh4aw-0 gqUMTP">Gatsby Starter Blog Grommet v2</h1></a><span class="StyledText-sc-1sadyjn-0 gAyINP">This is a DEMO site! SSG - Gatsby JS, UI - Grommet v2</span></div></header>XXXXXXXXXXXx<main><div><div class="StyledBox-sc-13pk1d4-0 fbPEuv"><div class="StyledBox-sc-13pk1d4-0 cRdLPJ"><div><article><div class="StyledBox-sc-13pk1d4-0 fmlxal"><div><header><div class="StyledBox-sc-13pk1d4-0 konoRe"><h1 class="StyledHeading-sc-1rdh4aw-0 hehAPz">Redux-Sagaでテトリス風ゲームを実装して学んだこと</h1><span class="StyledText-sc-1sadyjn-0 jRjNKe">February 20, 2020</span></div></header></div><div class="StyledBox-sc-13pk1d4-0 konoRe"><div><h1>はじめに</h1>
<p><a href="https://qiita.com/advent-calendar/2017/react">React #1 Advent Calendar 2017</a>の11日目です。</p>
<p>Reduxのミドルウェア「Redux-saga」で「やや複雑なリアルタイムゲーム」としてテトリス風のゲームの基本部分を開発し、それを通じて学んだこと・感じたことを紹介します。</p>
<h1>画面例</h1>
<p>まずは実装したテトリス風ゲームの画面例。矢印キーの左右下でピースを動かし、z,xで回転です。</p>
<p><img src="https://qiita-image-store.s3.amazonaws.com/0/9979/86cb9f8e-b2df-6747-51f0-fa7fefb1f2a5.gif" alt="sagaris.gif"></p>
<p><img src="https://qiita-image-store.s3.amazonaws.com/0/9979/b621eae9-5c08-3d95-f0ce-c3ee5b91c08e.gif" alt="sagaris2.mov.gif"></p>
<p>実際に<a href="https://uehaj.github.io/redux-saga-tetris/index.html">こちら</a>から遊べます。ソースコードは<a href="https://github.com/uehaj/redux-saga-tetris">こちら</a>から。</p>
<h1>テトリス風ゲーム実装を通じて学んだこと</h1>
<p>Redux-Sagaの効用として良く言われるのは、「作用を分離する」とか「テストを簡単にする」ということです。それ以外に、今回、ゲームの実装を通じて思ったこと、思いついたことをつらつらと書いていきたいと思います。</p>
<ul>
<li><strong><em>利点1.</em></strong> ビューからビジネスロジックを分離する</li>
<li><strong><em>利点2.</em></strong> ロジックとロジックの間を疎結合にする</li>
<li><strong><em>利点3.</em></strong> ロジックフローの明確化</li>
</ul>
<p>それぞれ説明します。</p>
<h2><strong><em>利点1.</em></strong> ビューからビジネスロジックを分離する</h2>
<h3>React単独だと分離できない</h3>
<p>コンポーネント指向のビューライブラリであるReactにおいて、ロジックは起点としてonClickなどに設定するコールバック関数、もしくはコールバックから呼び出す関数やメソッドで実現されます。このとき、依存性は以下のようになります。</p>
<p><img src="http://www.plantuml.com/plantuml/png/SoWkIImgAStDuSf9JIjHACbNACfCpoXHICaiIaqkoSpFuz9ut3pvSVFInyrxD1LqTUqK5802QnytxNZStFouQRqcbqDgNWfGFm00" alt="alt"></p>
<p>ビューはロジックに依存します。たとえば、イベントが発生したときに実行されるロジックの処理が存在するか否か、処理の個数、メソッド名や引数の変更などに応じてビューを変更しなければならない可能性があります。<sup id="fnref-11"><a href="#fn-11" class="footnote-ref">11</a></sup></p>
<h3>Reduxと組合わせれば…</h3>
<p>Reduxは、ビューから状態を分離します。さらにビューは「Actionをdispatchする」という建前なので、依存性は以下のようになります。</p>
<p><img src="http://www.plantuml.com/plantuml/png/SoWkIImgAStDuSf9JIjHACbNACfCpoXHICaiIaqkoSpFuz9ut3pvSVFInyrxD1LqTUqKD1p1uffS2d2cGbsT0b3PsiTDEnutDpzkMg_9vP2Qbm8q5G00" alt="alt"></p>
<p>Actionを介して依存性の逆転を行うことができ、ビューはActionのみに依存するようになります…。
…と言ったか? <b>それは嘘だ。</b></p>
<h3>Redux-thunk(その他)ではビュー→ロジックの依存性を排除できない</h3>
<p>Redux-thunkでは「Actionをdispatchするかわりに関数をdispatchする」というだけのものなので、「どの処理をすべきか考え、どこに処理があるかを見つけて取得するか記述して、dispatchに渡す」という責任がビューにあります。ロジックが記述されているのがメソッドであろうがアロー関数であろうが、Action Creatorで隠蔽しても同じことです。</p>
<p>Redux-thunkに限らず、ロジックをコンポーネントのメソッドに書く場合でも、mapDispathchToPropsに書く場合でも、ImmutableJSのRecordのメソッドに書く場合でも同じです。<sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup></p>
<p>もちろん、ロジックを変更したときにビューへの影響が最小限にするための努力は可能でしょう。たとえば、「将来に変更が必要にならないように、ロジックの関数名やシグネチャを十分事前に検討する」などです。しかしながら、予測できないことは発生するのが常であり、限界があると知るべきでしょう。</p>
<h3>Redux-Sagaで実現されるビュー→ロジックへの依存の完全排除</h3>
<p>Redux-Sagaでは、Actionは<strong><em>かならずシンプルなデータ</em></strong>であり、ビューが発行するActionに対してどんな処理が実行されるか、そもそも処理が実行されるかどうかすら、ビューの関知することではありません。このことがビューの債務を明確かつ単純にしてくれ、また試験を容易にしてくれることは明らかです。
Redux-Sagaの効用の一つは、以下のような依存性の逆転をきちんと実現することです。</p>
<p><img src="http://www.plantuml.com/plantuml/png/SoWkIImgAStDuSf9JIjHACbNACfCpoXHICaiIaqkoSpFuz9ut3pvSVFInyrxD1LqTUqKD1p1uffS2d2cWeskheB6uwRzZvjsFcvQh_-uUUtZfXsFcvk174qkXzIy5A050000" alt="alt"></p>
<p>Actionさえ完成していれば、ビューを完成させテストすることができるし、タスク/ロジックについても同様です。</p>
<p>タスクはRedux-Sagaが実現する並行動作の単位であり、Actionの発生を監視し、Actionに応じて処理を実行する存在です(Sagaと呼びます)。</p>
<p>さらに、<a href="http://www.s-arcana.co.jp/blog/2017/03/07/3499">『実践 Redux Saga』 – React, FLUX, Redux, Redux Saga – // 第21回社内勉強会 #sa_study</a>で紹介されている「<a href="https://medium.com/@marcelschulze/using-react-native-with-redux-and-redux-saga-a-new-proposal-ba71f151546f">Using React (-Native) with Redux and Redux-Saga. A new proposal?</a>」のアーキテクチャを援用すれば、ビューから発行されるのは「UIアクション」のみとなり、もはや「Action(動作)」という意識も薄れることになります。ビューの債務は、「動作」や「reducerでデータを更新すること」にも関知せず、「HOWや動作を考えず、UIアクション(そのUIイベントを最小完全に表現するデータ)を発行すること」に縮退するのです。</p>
<p>上記のアーキテクチャのポイントの一つは、ActionをUser/System/Reducer Actionの3種類にわけるというものですが、今回、ちょっとアレンジ<sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup>して、以下のようにしてみました。</p>
<ul>
<li>UIアクション…ビューのみが発行し、Sagaのみがtakeする。</li>
<li>システムアクション…ビューあるいはSagaが発行し、Sagaのみがtakeする。</li>
<li>Reducerアクション…Sagaのみが発行し、Reducerのみが受けとる。</li>
</ul>
<p>これに従って今回実装したテトリス風ゲームのAction一覧は以下のとおりです。</p>
<table>
<thead>
<tr>
<th style="text-align: left">種別</th>
<th style="text-align: left">アクション</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left" rowspan="5">UIアクション</td>
<td style="text-align: left">UI_BUTTON_CLICKED</td>
</tr>
<tr>
<td style="text-align: left">UI_KEY_DOWN</td>
</tr>
<tr>
<td style="text-align: left">UI_MODAL_OPEN</td>
</tr>
<tr>
<td style="text-align: left">UI_MODAL_OK</td>
</tr>
<tr>
<td style="text-align: left">UI_MODAL_CANCEL</td>
</tr>
<tr>
<td style="text-align: left" rowspan="5">システムアクション</td>
<td style="text-align: left">SYS_TIME_TICK</td>
</tr>
<tr>
<td style="text-align: left">SYS_GAME_START</td>
</tr>
<tr>
<td style="text-align: left">SYS_GAME_QUIT</td>
</tr>
<tr>
<td style="text-align: left">SYS_GAME_OVER</td>
</tr>
<tr>
<td style="text-align: left">SYS_FIX_DOWN_PIECE</td>
</tr>
<tr>
<td style="text-align: left" rowspan="8">Reducerアクション</td>
<td style="text-align: left">UPDATE_CELL</td>
</tr>
<tr>
<td style="text-align: left">SET_BOARD</td>
</tr>
<tr>
<td style="text-align: left">SET_CURRENT_PIECE</td>
</tr>
<tr>
<td style="text-align: left">SET_GAME_RUNNING</td>
</tr>
<tr>
<td style="text-align: left">SET_GAME_PAUSING</td>
</tr>
<tr>
<td style="text-align: left">SET_MODAL</td>
</tr>
<tr>
<td style="text-align: left">SET_SCORE</td>
</tr>
<tr>
<td style="text-align: left">ADD_SCORE</td>
</tr>
</tbody>
</table>
<p>イメージわきますでしょうか。システムアクションはロジックにかかわる、アプリケーションで発生する意味的なレベルのイベントです。
Reducerアクションのreducerでのハンドリングは本当に機械的なstoreの更新のみです。ロジックは全く・ほとんど含みません。もし含むとしたらバリデーションみたいなものでしょうか。</p>
<h3><strong><em>利点2.</em></strong> ロジックとロジックの間を疎結合にする</h3>
<p>Redux-Sagaではコンカレントに動作する複数のタスクを記述することができます。</p>
<p><img src="https://camo.qiitausercontent.com/f3a9835dc103b7037d34144facb1d0417f4205d6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f36393836302f38636331613837332d633637352d393030392d353730642d3936383464613461373034662e706e67" alt="alt">
(<a href="https://qiita.com/kuy/items/716affc808ebb3e1e8ac">「redux-sagaで非同期処理と戦う」</a>より引用)</p>
<p>並行動作するタスクととタスクの間の連携や連動、同期のキック処理は、ビューとタスクと同様に、シンプルデータとしてのActionのみが取り持ちます。(ちなみにこのときのActionは、go言語のCSPチャンネルのように振る舞っていると言えるんじゃないかと思います)</p>
<p>ビューとタスクの依存性を除去したのと同じように、タスク間において、タスクを追加したり、変更したりすることが他のタスクへの影響を及ぼさないようにすることができます<sup id="fnref-3"><a href="#fn-3" class="footnote-ref">3</a></sup>。</p>
<p>書き方にもよるのですが、たとえば今回のテトリス風ゲームで言えば、ゲームの起動画面の処理と、実際のゲームの処理を分けることができます。</p>
<p>以下は起動面側のタスク「<a href="https://github.com/uehaj/redux-saga-tetris/blob/master/src/sagas.js#L168">sagas.js</a>」での処理です。</p>
<pre><code class="language-js">function* demoScreen() {
  if (Config.PREDICTABLE_RANDOM) {
    Math.seedrandom('sagaris');
  }
  yield put(push('/'));

  while (true) {
    // デモ画面
    while ((yield take(Types.UI_KEY_DOWN)).payload !== Keys.KEY_S) {
      /* do nothinng */
    }
    // ゲーム開始
    yield put(Actions.setGameRunning(true));
    yield put(Actions.sysGameStart());
    // ゲームオーバー、もしくはQ押下を待つ
    const gameResult = yield race({
      over: take(Types.SYS_GAME_OVER),
      quit: take(Types.SYS_GAME_QUIT),
    });
    yield put(Actions.setGameRunning(false));
    if (gameResult.over) {
      // ゲームオーバー画面(確認ダイアログ)表示
      yield* gameOver();
    }
    yield put(push('/'));
  }
}
</code></pre>
<p>ここでは、“Ｓ”キーの入力を待ち、SYS<em>GAME</em>STARTイベントを発行し、SYS<em>GAME</em>OVERもしくはSYS<em>GAME</em>QUITイベントを待ちます。ゲームを実行する別のタスクがSYS<em>GAME</em>STARTイベントを待ち受けています。demoScreenは、gameのことを何も知りません。逆も然りです。</p>
<h3><strong><em>利点3.</em></strong> ロジックフローの明確化</h3>
<p>Redux-Saga以前、ブラウザ内で動作するJSコードはServiceWorker, WebWorkerを除き本質的には「イベントハンドラの集合」であり、複数のイベントに関連する「一連のロジック」を協調的に実行させる場合、イベントハンドラ間の連携は状態変数(reduxではstateなど)で表現する他はありませんでした。これはBSDソケットのselectを使った通信処理や、協調型イベントドリブンプログラミングと同じ状況で、コンテキストを維持するスレッド等が無いので「どこまで処理が進んだか」という情報で状態を共有できないためです。</p>
<p>たとえばウィザード形式の入力フォームで、入力が「どこまで進んだか」を表わすstateを保持するとか、あるいはモーダルダイログを「今開き中です」みたいなstateを定義するとかが典型的ですが、UIの複数箇所で進行中のものがあったりネストしたりすると記述が煩雑になります。</p>
<p>また、Redux-Sagaを使うと「待ち受ける処理」すなわちイベントハンドラやコールバックをプル型、すなわち同期的に「取ってきくる」処理のように記述できます。async/awaitと同じですが、Redux-SagaではGeratorを用いてPromiseに限らず前述のUIアクションやシステムアクションの待ちうけを実行することができます。</p>
<p>たとえば、テトリス風ゲームでは<a href="https://github.com/uehaj/redux-saga-tetris/blob/master/src/sagas.js#L88">タスクpieceFall</a>で以下のような処理を実行しています。</p>
<ol>
<li>新しい落下テトロミノのピースを乱数で決定する。</li>
<li>ピースをボードの初期位置に置けないならGAME_OVERシステムイベントを発行する</li>
<li>ピースを「現在のピース」に設定する</li>
<li>「キーの入力、一定時間経過、現在のピースが一番下まで落下して固着」のいずれかが発生するまで待つ</li>
<li>発生したイベントが「現在のピースが一番下まで落下して固着」のときスコアを増加</li>
<li>現在のピースが一番下まで落下したが未だ固着していないなら「余裕時間」タスクをバックグラウンド起動。</li>
<li>余裕時間タスクはカウントダウンして、余裕時間が終了すると「現在のピースが一番下まで落下して固着」イベントを発行</li>
<li>入力キーが’Q’や’P’のときポーズ処理や、終了の確認モーダルダイアログ処理</li>
<li>一定時間が経過したか、↓キーが入力されたときピースを下方移動。</li>
<li>その他の方向キーが入力されたときピースをその方向に移動</li>
</ol>
<p>該当部分のコードは以下のとおりです。</p>
<pre><code class="language-js:saga.js">  :
export function* pieceFall() {
  let piece = new Piece(3, 1, Math.floor(Math.random() * 7), 0);
  let board = yield select(state => state.main.board);
  if (!piece.canPut(board)) {
    // トップ位置に置けなければゲームオーバー
    yield put(Actions.sysGameOver());
    return;
  }
  yield put(Actions.setCurrentPiece(piece));

  let stcTask = null;
  while (true) {
    const { keyDown, fixDown, timeTick } = yield race({
      keyDown: take(Types.UI_KEY_DOWN),
      fixDown: take(Types.SYS_FIX_DOWN_PIECE),
      timeTick: take(Types.SYS_TIME_TICK),
    });
    if (fixDown) {
      // this piece is fall to bottom or other piece, and fixed
      board = piece.setTo(board);
      const [newBoard, clearedLines] = Board.clearLines(board);
      board = newBoard;
      yield put(Actions.setBoard(board));
      // line clear bonus
      yield put(Actions.addScore(Config.LINES_SCORE[clearedLines]));
      break;
    }
    // 固定時間処理タスクを起動
    if (piece.reachedToBottom(board)) {
      if (stcTask === null) {
        stcTask = yield fork(slackTimeChecker);
      }
    } else if (stcTask !== null) {
      // 固定時間中の操作で底から脱却したときは固定時間を抜ける
      yield cancel(stcTask);
      stcTask = null;
    }
    if (keyDown) {
      if (keyDown.payload === Keys.KEY_Q) {
        yield* gameQuit();
      } else if (keyDown.payload === Keys.KEY_P) {
        yield* gamePause();
      }
    }
    if (keyDown || (timeTick &#x26;&#x26; timeTick.payload % 60 === 0)) {
      // calcurate next piece position &#x26; spin
      const nextPiece = piece.nextPiece(
        (keyDown &#x26;&#x26; keyDown.payload) || Keys.KEY_ARROW_DOWN
      );
      if (nextPiece.canPut(board)) {
        if (
          nextPiece !== piece &#x26;&#x26;
          keyDown &#x26;&#x26;
          keyDown.payload === Keys.KEY_ARROW_DOWN
        ) {
          yield put(Actions.addScore(1));
        }
        piece = nextPiece;
        yield put(Actions.setCurrentPiece(piece));
      }
    }
  }
}
</code></pre>
<p>1つのピースを生成し、落下しつつ操作され、最後に固着するまでが一連の処理として書かれています。イベントを発生させたり、あるいはイベント発生を待ちあわせたり、「一連の処理」が連携し、データをローカル変数として共有しながら連続していきます。</p>
<p>このような一連の処理を、たとえばasync/awaitなり、Reduxステートなり、あるいはRxJSで読みやすく書けるのかに疑問を持っています。まあもちろん、Redux-Sagaのコードが本当に読みやすいかにも疑問を持つべきですが、可読性の底ぬけ崩壊を避け、踏ん張れるかな、という印象です。</p>
<h1>業務用アプリでも役にたつのか?</h1>
<p>もっとも、リアルタイムゲームではなく、一般的な業務用アプリで上記ぐらいの制御が求められるのか、という疑問もあるでしょう。この疑問については、まずは複雑なものを読み易く書き下せるなら、より簡単なものを書くことにも恩恵がある、ということが言えます。
また、以下のようなケースでは業務用アプリでも恩恵があるでしょう。</p>
<ul>
<li>ウィザード形式のフォーム入力など、ステップ・分岐で進行する処理。</li>
<li>
<p>サーバプッシュやサーバ状況変化への対応</p>
<ul>
<li>たとえば、編集している帳票が他の人によって削除されたり、チャットしている相手がログアウトする</li>
<li>たとえば「予約」のような刻々と状況が変化する対象に対する処理</li>
<li>たとえば監視系のコンソール</li>
<li>電波状況の変化によってオフライン・オンラインになったときのデータ更新、オフラインになっていた他者がオンラインになることによる更新</li>
</ul>
</li>
<li>IDEのような複数ペインで同時進行するUI処理。例えばVSCodeのコンソール出力やバックグラウンドでのエラーチェック、など。</li>
<li>
<p>比較的複雑な処理</p>
<ul>
<li>インクリメンタルサーチなどに伴い、非同期的な複数の値の取得、処理結果を整列させる、キャンセル、キャッシュ、スロットル、デバウンス、およびそれらの組合せ</li>
</ul>
</li>
<li>独立性の高いコンポーネント群としてアプリケーションを構成する。 利点3で示した利点により、アプリケーションをサブシステムとして(おそらくNPMとして)分離分割する戦略に貢献することができます。</li>
</ul>
<h1>3D化してみよう</h1>
<p>「ReduxおよびRedux-Sagaを使用することで、ビューとロジック・状態が完全分離できる」というのが本記事の主張です。その証明として、Sagaによるタスク定義とredux部分に1行たりとも変更を加えず、ビューだけを<a href="https://facebook.github.io/react-vr/">ReactVR</a>に置き変えてみます。</p>
<p><img src="https://qiita-image-store.s3.amazonaws.com/0/9979/eb1c4580-1536-c97b-4fdf-176d005d3e5f.gif" alt="tetrominovr.mov.gif"></p>
<p>いともたやすくVRゲーム化できました<sup id="fnref-4"><a href="#fn-4" class="footnote-ref">4</a></sup>。<a href="https://uehaj.github.io/rect-vr-samples/TetrominoGame0/index.html">こちらからゲームをプレイ</a>できます。カードボードなどVRゴーグルがあれば没入できるはずです。ソースコードは<a href="https://github.com/uehaj/rect-vr-samples/tree/master/TetrominoGame">こちら</a>から。</p>
<h1>まとめ</h1>
<ul>
<li>Redux-SagaはReduxのキラーアプリケーション。このためだけにReduxを使うということもあり。</li>
<li>速度もこのぐらいなら十分だった。</li>
<li>ビュー・ロジック間、ロジック間の疎結合性が特によいところ。</li>
<li>「思いっきり命令型」だと? わーっわーっわーっ。聞こえない聞こえない(耳を塞いで)</li>
<li>requestAnimationFrameをSagaから実行してTIME_TICKアクションを発行してますが、副作用なので本当はモックするとかせんといかん</li>
</ul>
<h1>おまけ</h1>
<p>去年のRedux Advent Calenderで「<a href="https://qiita.com/kuy/items/fd4ae1e3e3b34f934756">Obelisk.jsとReduxで3Dテトリス「Oberis」を作ってみた
</a>」という記事があることに気づきました。3Dまでまるかぶりや。普遍性があるということで。</p>
<h1>参考、ReactVRの記事</h1>
<ul>
<li><a href="https://www.ntt-tx.co.jp/column/dojo_review_blog/20170511/">VRコンテンツをWebアプリのように開発するReact VR登場、その1【がっつりReact!シリーズ 第1回】
</a></li>
<li><a href="https://www.ntt-tx.co.jp/column/dojo_review_blog/20170929/">React VRで太陽系を創ろう、3次元モデリングとアニメーションの基礎(前編)【がっつりReact!シリーズ 第2回】
</a></li>
</ul>
<div class="footnotes">
<hr>
<ol>
<li id="fn-11">
<p>ここで言う「ビュー」はReactコンポーネントを組合せて作られたビュー全体です。コールバック関数をpropsで外部から供給すれば、そのコンポーネントはロジックから独立になりますが、それはpropsを供給する側のコンポーネントに責任が移動したにすぎません。</p>
<a href="#fnref-11" class="footnote-backref">↩</a>
</li>
<li id="fn-1">
<p>redux-promise<del>~やredux-observable(redux-observableでは同様にアクションを監視できるので削除。)</del>~でも同じと思うが良く知らないので自信なし。</p>
<a href="#fnref-1" class="footnote-backref">↩</a>
</li>
<li id="fn-2">
<p>元のアーキテクチャではシステムアクションはビューが発行しSagaでは発行しない。しかしたとえばrequestAnimatonFrameなどSagaで管理した方がやりやすいものがあり、また「タスク間の疎結合」の実現のためにも有用なので、システムアクションはSagaでも発行するようにした。</p>
<a href="#fnref-2" class="footnote-backref">↩</a>
</li>
<li id="fn-3">
<p>もちろん直接fork作用でタスクをバックグラウンド起動したりするとこの疎結合性は失なわれる。</p>
<a href="#fnref-3" class="footnote-backref">↩</a>
</li>
<li id="fn-4">
<p>react-routerの組込みなど未完成です。</p>
<a href="#fnref-4" class="footnote-backref">↩</a>
</li>
</ol>
</div></div></div></div></article><aside><div class="StyledBox-sc-13pk1d4-0 juZNvr"><button type="button" class="StyledButton-sc-323bzc-0 fIeKgP"><div class="StyledBox-sc-13pk1d4-0 cHqCJo"><svg aria-label="Previous" viewBox="0 0 24 24" class="StyledIcon-ofa7kd-0 iOkQrb"><polyline fill="none" stroke="#000" stroke-width="2" points="7 2 17 12 7 22" transform="matrix(-1 0 0 1 24 0)"></polyline></svg><div class="StyledBox__StyledBoxGap-sc-13pk1d4-1 bUsBUB"></div>Previous</div></button><div class="StyledBox__StyledBoxGap-sc-13pk1d4-1 hGMbC"></div><button type="button" class="StyledButton-sc-323bzc-0 fIeKgP"><div class="StyledBox-sc-13pk1d4-0 cHqCJo">Next<div class="StyledBox__StyledBoxGap-sc-13pk1d4-1 bUsBUB"></div><svg aria-label="Next" viewBox="0 0 24 24" class="StyledIcon-ofa7kd-0 iOkQrb"><polyline fill="none" stroke="#000" stroke-width="2" points="7 2 17 12 7 22"></polyline></svg></div></button></div></aside></div></div><div class="StyledBox-sc-13pk1d4-0 kTNrrC"><div><div></div><aside><div><div><div class="StyledBox-sc-13pk1d4-0 cPEInk"><div class="StyledBox-sc-13pk1d4-0 fbPEuv"><div class="StyledBox-sc-13pk1d4-0 dusloy"><img title="Ivan Ganev" alt="Ivan Ganev" src="https://pbs.twimg.com/profile_images/986603715732934656/7A4Nt68k_400x400.jpg" class="StyledImage-ey4zx9-0 UumnI"/></div><div class="StyledBox-sc-13pk1d4-0 koruWX"><span class="StyledText-sc-1sadyjn-0 ffajHy">Ivan Ganev</span></div></div><div class="StyledBox-sc-13pk1d4-0 fhTKrx"><a href="https://twitter.com/ganevru" class="StyledButton-sc-323bzc-0 fiDkPX"><svg aria-label="Twitter" viewBox="0 0 24 24" class="StyledIcon-ofa7kd-0 iOkQrb"><path fill="#1DA1F2" fill-rule="evenodd" d="M24,4.3086 C23.117,4.7006 22.168,4.9646 21.172,5.0836 C22.188,4.4746 22.969,3.5096 23.337,2.3596 C22.386,2.9246 21.332,3.3336 20.21,3.5556 C19.312,2.5976 18.032,1.9996 16.616,1.9996 C13.897,1.9996 11.692,4.2046 11.692,6.9236 C11.692,7.3096 11.736,7.6856 11.82,8.0456 C7.728,7.8406 4.099,5.8806 1.671,2.9006 C1.247,3.6286 1.004,4.4736 1.004,5.3766 C1.004,7.0846 1.873,8.5926 3.195,9.4756 C2.388,9.4486 1.628,9.2276 0.964,8.8596 L0.964,8.9206 C0.964,11.3066 2.661,13.2966 4.914,13.7486 C4.501,13.8626 4.065,13.9216 3.617,13.9216 C3.299,13.9216 2.991,13.8906 2.69,13.8336 C3.317,15.7896 5.135,17.2136 7.29,17.2536 C5.604,18.5736 3.481,19.3606 1.175,19.3606 C0.777,19.3606 0.385,19.3376 0,19.2926 C2.179,20.6886 4.767,21.5046 7.548,21.5046 C16.605,21.5046 21.557,14.0016 21.557,7.4946 C21.557,7.2816 21.552,7.0696 21.543,6.8586 C22.505,6.1636 23.34,5.2966 24,4.3086"></path></svg></a><a href="https://github.com/ganevru" class="StyledButton-sc-323bzc-0 fiDkPX"><svg aria-label="Github" viewBox="0 0 24 24" class="StyledIcon-ofa7kd-0 iOkQrb"><path fill="#333" fill-rule="evenodd" d="M11.9989871,1 C5.92550416,1 1,5.92482888 1,12.0003376 C1,16.8603395 4.15153934,20.9829338 8.52263728,22.4374904 C9.0729918,22.5387827 9.27355045,22.199116 9.27355045,21.9073943 C9.27355045,21.6467356 9.2640965,20.954572 9.25869425,20.0368642 C6.19899322,20.7013414 5.55342398,18.5620492 5.55342398,18.5620492 C5.0530403,17.2911692 4.33183953,16.9528531 4.33183953,16.9528531 C3.33309801,16.2708186 4.40747107,16.2843243 4.40747107,16.2843243 C5.51155652,16.3619816 6.09229872,17.4181221 6.09229872,17.4181221 C7.07348292,19.0988981 8.66714755,18.6133706 9.2938089,18.3317781 C9.39375058,17.6213819 9.67804414,17.1365297 9.99205009,16.86169 C7.54955646,16.5841493 4.98146045,15.6401056 4.98146045,11.4249977 C4.98146045,10.224347 5.41026428,9.24181221 6.11390773,8.47334172 C6.00046042,8.19512569 5.62297799,7.07618404 6.22195279,5.56220265 C6.22195279,5.56220265 7.14506277,5.26642929 9.24653918,6.68992296 C10.12373,6.44547101 11.0650726,6.32392032 12.0003376,6.31919335 C12.9349274,6.32392032 13.8755947,6.44547101 14.7541361,6.68992296 C16.8542619,5.26642929 17.7760214,5.56220265 17.7760214,5.56220265 C18.3763467,7.07618404 17.9988643,8.19512569 17.8860923,8.47334172 C18.5910863,9.24181221 19.0165137,10.224347 19.0165137,11.4249977 C19.0165137,15.6509101 16.444366,16.5807729 13.9944443,16.8529114 C14.3888087,17.192578 14.7406305,17.863808 14.7406305,18.890236 C14.7406305,20.3603241 14.7271248,21.5467939 14.7271248,21.9073943 C14.7271248,22.2018171 14.9256576,22.5441849 15.4834403,22.4368151 C19.8511618,20.9788821 23,16.8589889 23,12.0003376 C23,5.92482888 18.0744958,1 11.9989871,1"></path></svg></a><a href="https://reddit.com/user/ganevru" class="StyledButton-sc-323bzc-0 fiDkPX"><svg aria-label="Reddit" viewBox="0 0 24 24" class="StyledIcon-ofa7kd-0 iOkQrb"><path fill="#FF4500" fill-rule="evenodd" d="M15.57,15.284 C14.673,15.284 13.91925,14.5565 13.91925,13.6595 C13.91925,12.7625 14.673,12.011 15.57,12.011 C16.467,12.011 17.1945,12.7625 17.1945,13.6595 C17.1945,14.5565 16.467,15.284 15.57,15.284 M15.951,18.437 C15.1155,19.27175 13.827,19.6775 12.012,19.6775 C12.00825,19.6775 12.00375,19.67675 11.99925,19.67675 C11.9955,19.67675 11.991,19.6775 11.9865,19.6775 C10.1715,19.6775 8.88375,19.27175 8.049,18.437 C7.7925,18.1805 7.7925,17.76575 8.049,17.51 C8.30475,17.25425 8.7195,17.25425 8.976,17.51 C9.552,18.086 10.53675,18.3665 11.9865,18.3665 C11.991,18.3665 11.9955,18.36725 11.99925,18.36725 C12.00375,18.36725 12.00825,18.3665 12.012,18.3665 C13.46175,18.3665 14.44725,18.086 15.024,17.51 C15.2805,17.2535 15.69525,17.25425 15.951,17.51 C16.20675,17.7665 16.20675,18.18125 15.951,18.437 M6.8055,13.6595 C6.8055,12.76325 7.55775,12.011 8.454,12.011 C9.351,12.011 10.0785,12.76325 10.0785,13.6595 C10.0785,14.5565 9.351,15.284 8.454,15.284 C7.55775,15.284 6.8055,14.5565 6.8055,13.6595 M19.998,3.311 C20.6055,3.311 21.09975,3.80525 21.09975,4.412 C21.09975,5.0195 20.6055,5.51375 19.998,5.51375 C19.3905,5.51375 18.89625,5.0195 18.89625,4.412 C18.89625,3.80525 19.3905,3.311 19.998,3.311 M24,11.87525 C24,10.2845 22.70625,8.99075 21.1155,8.99075 C20.427,8.99075 19.79475,9.23375 19.29825,9.638 C17.5395,8.5325 15.3075,7.8665 12.915,7.7255 L14.163,3.77975 L17.59275,4.5875 C17.68275,5.83625 18.72675,6.82475 19.998,6.82475 C21.32775,6.82475 22.41,5.7425 22.41,4.412 C22.41,3.08225 21.32775,2 19.998,2 C19.068,2 18.2595,2.5295 17.85675,3.30275 L13.87125,2.3645 C13.5375,2.28575 13.2,2.47775 13.0965,2.80475 L11.547,7.70225 C8.96925,7.76525 6.546,8.4335 4.65825,9.6035 C4.1685,9.22025 3.55275,8.99075 2.8845,8.99075 C1.29375,8.99075 0,10.2845 0,11.87525 C0,12.8585 0.495,13.72775 1.24875,14.24825 C1.21725,14.477 1.20075,14.70725 1.20075,14.9405 C1.20075,16.92875 2.3565,18.77825 4.455,20.14775 C6.4665,21.461 9.129,22.184 11.95125,22.184 C14.7735,22.184 17.436,21.461 19.4475,20.14775 C21.546,18.77825 22.70175,16.92875 22.70175,14.9405 C22.70175,14.72825 22.6875,14.5175 22.66125,14.30825 C23.46525,13.796 24,12.89675 24,11.87525"></path></svg></a></div><div class="StyledBox-sc-13pk1d4-0 egLqqe"><span class="StyledText-sc-1sadyjn-0 AGUoN"><span>Hello, I&#x27;m Ivan Ganev and I made this blog starter for Gatsby js using UI Grommet v2. <br/><br/>Repo of this starter: <a class="StyledAnchor-sc-1rp7lwl-0 gRPiLc" href="https://github.com/ganevru/gatsby-starter-blog-grommet">github.com/ganevru/gatsby-starter-blog-grommet</a><br/><br/>Go here: site-config.js, and replace this text with your own</span></span></div></div></div><div class="StyledBox-sc-13pk1d4-0 hiQlop"><button type="button" class="StyledButton-sc-323bzc-0 jfbKsv"><div class="StyledBox-sc-13pk1d4-0 kPraOX"><svg aria-label="Actions" viewBox="0 0 24 24" class="StyledIcon-ofa7kd-0 iOkQrb"><path fill="none" stroke="#000" stroke-width="2" d="M12,17.5 C15.0375661,17.5 17.5,15.0375661 17.5,12 C17.5,8.96243388 15.0375661,6.5 12,6.5 C8.96243388,6.5 6.5,8.96243388 6.5,12 C6.5,15.0375661 8.96243388,17.5 12,17.5 Z M12,6.5 L12,1 M12,23 L12,17.5 M1,12 L6.5,12 M17.5,12 L23,12 M4.4375,4.4375 L8.5625,8.5625 M15.4375,15.4375 L19.5625,19.5625 M19.5625,4.4375 L15.4375,8.5625 M8.5625,15.4375 L4.4375,19.5625"></path></svg><span class="StyledText-sc-1sadyjn-0 fYEUgR">Enable Dark Theme</span></div></button></div></div></aside></div></div></div></div></main></div></div><footer><div class="StyledBox-sc-13pk1d4-0 cXcbzr"><span class="StyledText-sc-1sadyjn-0 ikIgfp"><span><strong>2018</strong><br/><br/>Go here: site-config.js, and replace this text with your own</span></span></div></footer></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'ADD YOUR TRACKING ID HERE', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/eaa039a7ce44d5969f06/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-e0726d491e263e7a514d.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-ebda79b2f242b4f85f83.js"],"component---src-templates-blog-post-tsx":["/component---src-templates-blog-post-tsx-99185ea61b7c1db80950.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-6b4c408d24e05a7f5e56.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-631502b66e8bcf4559a7.js"]};/*]]>*/</script><script src="/uehaj-memo/component---src-templates-blog-post-tsx-99185ea61b7c1db80950.js" async=""></script><script src="/uehaj-memo/02d529e9c63de17f611aad8b1faf348db0081e69-ac0923b45693387c242c.js" async=""></script><script src="/uehaj-memo/7f7e17e10404ffebb7b543ed2a7939618d5b9b2d-c38ec7352d8148819306.js" async=""></script><script src="/uehaj-memo/app-e0726d491e263e7a514d.js" async=""></script><script src="/uehaj-memo/framework-a61069b645629c49bb6a.js" async=""></script><script src="/uehaj-memo/webpack-runtime-fb996b323eeedf59d2e2.js" async=""></script></body></html>