---
date: 2020-02-20T15:08:12.174Z
path: /f91d68ea4ef8450fc45c.md/index.html
template: BlogPost
title: Redux Starter Kitã§Hooksã¨Reduxã‚’ä½¿ã„ã“ãªãã†
tags: React redux redux-starter-kit react-hooks
author: uehaj
slide: false
---
<table>
<tr><td>Redux Sterter Kitã¯Redux-Toolkitã«åç§°å¤‰æ›´ã•ã‚Œã¦APIã‚‚å¤‰æ›´ã•ã‚Œã¦ã„ã¾ã™ã€‚æœ¬è¨˜äº‹ã¯ãã®ã¾ã¾ã§ã¯æœ€æ–°ç‰ˆredux-toolkitã¨ã—ã¦å‹•ä½œã—ã¾ã›ã‚“ã€‚
https://github.com/reduxjs/redux-toolkit</td></tr>
<table>
#ã¯ã˜ã‚ã«

React-Reduxã®å…¬å¼ã‹ã‚‰ã€Œ[Redux Starter Kit](https://redux-starter-kit.js.org/)ã€ã¨ã„ã†ã‚‚ã®ãŒå…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

ã“ã‚ŒãŒãªã«ã‹ã¨ã„ãˆã°ã€ç§ã®ç†è§£ã™ã‚‹ã‹ãã‚Šä»¥ä¸‹ã§ã™ã€‚
> React-Reduxã¾ã‚ã‚Šã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã€å®šç•ªæ‹¡å¼µã€å®šç•ªä½µç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€å®šç•ªãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’ã€ç°¡å˜ã«çµ„è¾¼ã‚€ãŸã‚ã®ç°¡å˜ã§è»½ã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€ãƒ¡ã‚¿ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã€‚

CLIã‚³ãƒãƒ³ãƒ‰ã§ã¯ãªããƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚
ã“ã‚Œã¯è‰¯ã„ã‚‚ã®ã ã¨æ€ã„ã¾ã—ãŸã®ã§å…¨åŠ›ã§ãŠå‹§ã‚ã—ã¦ã„ãã¾ã™ã€‚
# ç‰¹å¾´

- TypeScriptãƒ•ãƒ«å¯¾å¿œã€‚å½“ç„¶ã§ã™ã­ã€‚
- React Redux 7.1å¯¾å¿œã€ã¤ã¾ã‚ŠHookså¯¾å¿œã€‚ã“ã‚Œã‹ã‚‰ã¯Hooksã§ç”Ÿãã¦ã„ãã€‚Hooksã®ç„¡ã„äººç”Ÿã¯è€ƒãˆã‚‰ã‚Œãªã„ã€‚
- [Immer](https://github.com/immerjs/immer)ãŒçµ„è¾¼ã¾ã‚Œã‚‹ã“ã¨ã§ã€[ç›´æ¥stateå¤‰æ›´](https://redux-starter-kit.js.org/api/createreducer#direct-state-mutation)å¯èƒ½ã«ãªã‚Šã€reducerè¨˜è¿°ãŒç°¡æ½”ã«ãªã‚‹ã€‚ã“ã‚Œã¯ã‚¤ã‚¤! ä¸€ç•ªã®æ¨ã—ãƒã‚¤ãƒ³ãƒˆã‹ã‚‚ã—ã‚Œãªã„ã€‚MobXã®åˆ©ç‚¹ã‚’ä¸€éƒ¨ã¨ã‚Šã“ã‚“ã ã¨è¨€ãˆã‚‹ã®ã‹ã‚‚??(è¿½è¨˜ã€å¾Œã§çŸ¥ã£ãŸã®ã§ã™ãŒã€Mobxã¨Immerã®ä½œè€…ã¯åŒã˜) ReduxãŒå†—é•·? æ˜”ã®è©±ã§ã™ã€‚ğŸ‰ğŸ‰ğŸ‰ğŸ‰
    - Immutable.jsã¨ãã‚‰ã¹ã¦Immerã®ã„ã„ã¨ã“ã‚ã¯ã€Immutable.jsã®ã‚ˆã†ã«è¨˜è¿°ãŒç‰¹æ®Šã«ãªã‚‰ãªã„ã“ã¨ãŒä¸€ã¤ã¨ã€ä»–ã«ã€åŒã˜ãã‚‰ã„é‡è¦ãªã®ã¯ã€ä»–ã®ç®‡æ‰€ã«Immutable.jsã®è¦æ±‚ã™ã‚‹ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’æ„ŸæŸ“ã•ã›ã¦ã„ã‹ãªã„ã“ã¨ã€‚éä¾µè¥²çš„ã€‚é‡è¦ã€‚
- Sliceãªã‚‹ã‚‚ã®ã§ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã§ãã‚‹ã€‚
    - Sliceã¯[Redux Ducks](https://redux.js.org/faq/code-structure#what-should-my-file-structure-look-like-how-should-i-group-my-action-creators-and-reducers-in-my-project-where-should-my-selectors-go)ãŒæä¾›ã™ã‚‹ã‚‚ã®ã¨[ä¼¼ãŸ](https://redux-starter-kit.js.org/api/createslice#return-value)ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¦‚å¿µã€‚åŒã˜ã§ã¯ãªã„ã‚‰ã—ã„ã€‚
   - Sliceã¯ä»¥ä¸‹ã‚’æŸã­ãŸã‚‚ã®ã€‚
     - Redux Stateã®ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®sliceã€‚ãŸã ã—ã“ã‚Œã¯ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ã§ã€sliceã«ã‚ã‘ãªã„ã“ã¨ã‚‚ã§ãã‚‹ã€‚
     - ãã‚Œãã‚Œã”ã¨ã®ã€combineReducerã§ã¾ã¨ã‚ã‚‹å…ƒã¨ãªã‚‹ãã‚Œãã‚Œã®Reducerç¾¤
     - sliceã”ã¨ã®StateåˆæœŸå€¤
- Sliceã‹ã‚‰action creatorã¯***å‹ä»˜ã***ã§è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ğŸ‰ğŸ‰ğŸ‰ğŸ‰
    - ACTIONå®šç¾©ã¯å®Œå…¨ã«æ¶ˆãˆã‚‹ã€‚actionå®šæ•°ã‚‚ã€‚creatorã‚‚ã€‚1è¡Œã‚‚ã€‚ä¸€è¡Œã‚‚ã ã€‚ReduxãŒå†—é•·? æ˜”ã®è©±ã§ã™ã€‚ğŸ‰ğŸ‰ğŸ‰ğŸ‰
- ã“ã‚Œã¯React-Reduxã®æ©Ÿèƒ½ã®è‰¯ã•ã‹ã‚‰ã ãŒã€
    - useSelectorå‘¼ã³å‡ºã™hookã‚’slice Moduleå´ã§å®šç¾©ã™ã‚Œã°ã€ã‚‚ã†ã»ã‚“ã¨ã«stateã¨ã‚Šã ã—ã¯æ¥½ã§ã™ã€‚
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ä»Šã¯ã€Œ[immutableStateInvariant, thunk, serializableStateInvariant]ã®[ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãŒè¨­å®šã•ã‚Œã‚‹](https://redux-starter-kit.js.org/api/getdefaultmiddleware#development)ã€‚thunkã¯è­°è«–ã‚ã‚‹ã§ã—ã‚‡ã†ãŒã€ä½¿ã‚ãªã„ã“ã¨ã‚‚ã‚‚ã¡ã‚ã‚“å¯èƒ½ã€‚
- Redux DevToolsã®è¨­å®šãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å…¥ã£ã¦ã„ã‚‹ã€‚
- ä¸Šè¨˜ã®ã‚ˆã†ãªã“ã¨ã®ãƒ¯ã‚¤ã‚¢ãƒªãƒ³ã‚°ãŒ1ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã§ãã‚‹ã€‚ğŸ‰ğŸ‰ğŸ‰ğŸ‰
    - [configureStoreã¾ã‚ã‚Šã®middlewareEnhancerã¨ã‹applyMiddlewareã¨ã‹composedEnhancersã¨ã‹ã®ã”ã¡ã‚ƒã”ã¡ã‚ƒã—ãŸé›£ã—ã„ã¨ã“ã‚](https://redux-starter-kit.js.org/usage/usage-guide#manual-store-setup)ãŒ[ã‚¹ãƒƒã‚­ãƒª](https://redux-starter-kit.js.org/usage/usage-guide#simplifying-store-setup-with-configurestore)ã§ãã‚‹ã€‚

ä¸Šè¨˜ã¯ã“ã‚Œã ã‘ã§ã‚‚ç´ æ™´ã‚‰ã—ã„ã¨æ€ã†ã®ã§ã™ãŒã€ã•ã‚‰ã«å…¬å¼ã‹ã‚‰ã€ã¨ã„ã†ã®ãŒå®‰å¿ƒæ„ŸãŒã‚ã£ã¦è‰¯ã„ã§ã™ã€‚ã“ã®å½¢ã®ReduxãŒãƒ‡ãƒ•ã‚¡ã‚¯ãƒˆã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ã¨æ‰±ã‚ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã“ã¨ã‚’æœŸå¾…ã—ã¾ã™ã€‚
# ã‚³ãƒ¼ãƒ‰ä¾‹

ã¾ãšã¯ã€TodoMVCã¿ãŸã„ãªã‚‚ã®ã‚’ä½œã‚‹ã¨ã—ã¾ã™ã€‚ãã®ã¨ãã®ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‚’redux stateã¨ã—ã¦ã‚ã¤ã‹ã†ã¨ã—ã¾ã™ã€‚ãã®ãŸã‚ã«Todoã‚’ã‚ã¤ã‹ã†ãŸã‚ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã“ã‚“ãªé¢¨ã«å®šç¾©ã—ã¾ã™ã€‚

```typescript:todoModule.ts
import { createSlice } from "redux-starter-kit";
import { useSelector } from "react-redux";

export type TodoItem = {
    title: string;
    completed: boolean;
    key: string;
}
// createSlice() ã§ actions ã¨ reducers ã‚’ä¸€æ°—ã«ç”Ÿæˆ
const todoModule = createSlice({
    // slice: "todo",
    initialState: [] as TodoItem[],
    reducers: {
        addTodo: (state, action: { payload: TodoItem }) => {
            state.push(action.payload)
        },
        removeTodo: (state, action: { payload: string }) => {
            return state.filter((item) => item.key !== action.payload);
        },
        setCompleted: (state, action: { payload: { completed: boolean, key: string } }) => {
            state.forEach((item) => {
                if (item.key === action.payload.key) {
                    item.completed = action.payload.completed;
                }
            });
        },
    }
});

export const useTodoItems = () => {
    return useSelector((state: ReturnType<typeof todoModule.reducer>) => state);
}
// ä»–ã«ä¾¿åˆ©ãªuseSelectå‘¼ã³å‡ºã—ã‚„ã€ç²’åº¦ã®ç´°ã‹ã„action creatorã®exportã‚’ã“ã“ã«è¿½åŠ ã—ã¦ã„ã£ã¦ã‚‚ã„ã„ã€‚

export default todoModule;
``` 
Immerã®ãŠã‹ã’ã§ã€reducerãŒåŠ‡çš„ã«ç°¡æ½”ã«ãªã£ã¦ã¾ã™ã€‚stateã‚’ã¾ã‚‹ã”ã¨ãŠãã‹ãˆã‚‹ã¨ãã¯returnã§è¿”ã—ã¾ã™ã€‚ã‚ã¨ã¯ä»£å…¥ãªã©ã§å‰¯ä½œç”¨ãƒãƒªãƒãƒªã§æ›¸ã„ã¦ã¾ã™ãŒProxyçµŒç”±ãªã®ã§å®Ÿéš›ã«ã¯Stateã‚’å¤‰æ›´ã—ã¦ã„ã¾ã›ã‚“ã€‚

ä¸Šã§ã¯combineReducerã‚‚ä½¿ã‚ãªã„ã¨ã„ã†å‰æã§sliceãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯å®šç¾©ã—ã¦ã¾ã›ã‚“ã€‚ã‚‚ã¡ã‚ã‚“è¦æ¨¡ãŒå¤§ãããªã‚Œã°ä½¿ã£ã¦ã‚‚ã‹ã¾ã„ã¾ã›ã‚“ã€‚ä½¿ã£ãŸã¨ã—ã¦ã‚‚sliceã®å­˜åœ¨ã¯æœ€å¾Œã®useTodoItemsã§éš è”½ã§ãã¾ã™ã€‚
ã¡ãªã¿ã«ã€dispatchã§ã¾ã‚‹ã”ã¨å…¬é–‹ã™ã‚‹ã®ã¯æ¥½ã¨ã¯ã„ãˆç²—ã„ã€ã¨ã„ã†äººã¯ã€[ã¡ã¾ã¡ã¾ã¨action creatorã‚’å…¬é–‹ã—ã¦ã„ãã“ã¨ã‚‚ã§ãã¾ã™](https://redux-starter-kit.js.org/usage/usage-guide#exporting-and-using-slices)ã€‚ãŠå¥½ã¿ã§ã€‚

ä¸€ã¤ã ã‘ã€ã“ã®è¨˜äº‹ã§ç‹¬è‡ªã«ææ¡ˆã—ãŸã„ã“ã¨ã¨ã—ã¦ã€**useSelectorã®å‘¼å‡ºã¯ã€ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å´ã§Hooks(ã“ã“ã§ã¯useTodoItems)ã¨ã—ã¦å®šç¾©ã—ã¦ã€ä½¿ã„ã‚„ã™ãã—ãŸã‚‚ã®ã‚’exportã™ã‚‹**ã¨ã„ã†ã“ã¨ã§ã™ã€‚ç‰¹ã«ã€useSelectorã®ç›´æ¥å‘¼å‡ºã¯å‹å®šç¾©ã«é–¢ã—ã¦é•·ãç…©é›‘ã«ãªã‚ŠãŒã¡ã§ã€ã“ã¡ã‚‰ã«éš è”½ã™ã‚‹ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚Šã¾ã™ã€‚

æ¬¡ã«ã€ä¸Šã«å«ã¾ã‚Œã‚‹reducerã‹ã‚‰ä»¥ä¸‹ã®ã‚ˆã†ã«storeã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãŒçµ„ã¿è¾¼ã¾ã‚Œã¾ã™ãŒã€ã‚‚ã¡ã‚ã‚“å¥½ããªã‚‚ã®ã‚’çµ„ã¿ã“ã‚ã‚‚ã—ã¾ã™ã€‚

```typescript:store.ts
import { configureStore } from "redux-starter-kit";
import todoModule from "./modules/todoModule";

export const setupStore = () => {
    const store = configureStore({
        reducer: todoModule.reducer
    });
    return store
}
```

ãã®storeã‹ã‚‰ä»¥ä¸‹ã®ã‚ˆã†ã«Providerã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã‚¢ãƒ—ãƒªã«çµ„ã¿è¾¼ã‚“ã§ã€

```typescript:App.tsx
import React from 'react';
import ReactDOM from 'react-dom';
import App from './App';
import { Provider } from "react-redux";
import { setupStore } from "./store";

const store = setupStore();

ReactDOM.render(
    <Provider store={store}>
        <App />
    </Provider>,
    document.getElementById('root'));
serviceWorker.unregister();
```
æº–å‚™ã¯å®Œäº†ã€‚
ã‚ã¨ã¯ã€ãã‚Œãã‚Œã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰storeã®å€¤ã‚’ã¤ã‹ã„ãŸã‘ã‚Œã°ã€

```typescript
import { useTodoItems } from "./modules/todoModule";
  :
  const todos = useTodoItems();
```

actionã‚’ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã—ãŸã‘ã‚Œã°ã€

```typescript
import { useDispatch } from "react-redux";
import todoModule from "./modules/todoModule";

  ï¼š
  const dispatch = useDispatch();

  dispatch(todoModule.actions.addTodo({ title: "TITLE", completed: false, key: 'XXX' }))  

  const todos = useTodoItems();
  const todo = todos[key];

  dispatch(todoModule.actions.setCompleted({ key: todo.key, completed: !todo.completed }));
  dispatch(todoModule.actions.removeTodo(todo.key));
```

ã®ã‚ˆã†ã«ã€ä»»æ„ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰ã‚‚è‡ªç”±è‡ªåœ¨ã§ã™ã€‚connect, mapStateToProps, mapDispatchToPropsã‚ˆã•ã‚‰ã°ã€‚

ä»¥ä¸Šã§ã™ã€‚ã‚¶ãƒƒãƒ„ã‚ªãƒ¼ãƒ«ã€‚ãƒŠãƒƒã‚·ãƒ³ã‚°ã‚¨ãƒ«ã‚¹ã€‚é©šç•°çš„ã«ç°¡å˜ã«ãªã£ãŸã‚ã‘ã§ã™ã€‚

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã§çŠ¶æ…‹ã‚’å…±æœ‰ã™ã‚‹å ´åˆã¯ã€é–“é•ã„ãªã**ç´ ã®useStateã§ã‚„ã‚‹ã‚ˆã‚Šã‚‚ç°¡å˜**ã«ãªã‚Šã¾ã™ã€‚ã‚ã£ã¡ã¯Immerä½¿ãˆãªã„ã§ã™ã—[^1]ã€stateã®setterã‚’ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§å–ã‚Šå›ã—ãŸã‚Šã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã¨ã‚Šã¾ã‚ã™ã®ã¯ã¤ã‚‰ã„ã§ã™ã‹ã‚‰ã­ã€‚

[^1]: [ã“ã¡ã‚‰](https://qiita.com/seya/items/f6d311b32cf711a02020)ã«ã‚ã‚‹ã‚ˆã†ãªå„ç¨®Hooks(useArrayã¨ã‹)ã‚’ä½¿ãˆã°ã€Immerã«åŒ¹æ•µã™ã‚‹ãã‚‰ã„ã«ã¯æ¥½ã‹ã‚‚ã—ã‚Œãªã„ã€‚

# å‚è€ƒ

- [Redux ã®è¨˜è¿°é‡å¤šã™ããªã®ã§ã€ Redux ã®å…¬å¼ãƒ„ãƒ¼ãƒ«ã§ã¨ã“ã¨ã‚“æ¥½ã‚’ã™ã‚‹ ( Redux Starter Kit)](https://qiita.com/Ouvill/items/a76e9cbce569d01f2931)

